# QEMU è™šæ‹Ÿæœºé…ç½®é€ŸæŸ¥è¡¨

## ğŸš€ å¿«é€Ÿå‘½ä»¤

### åŸºç¡€æ“ä½œ
```bash
# èµ‹äºˆè„šæœ¬æ‰§è¡Œæƒé™
chmod +x *.sh

# åˆ›å»º Windows è™šæ‹Ÿæœº
./create-windows-vm.sh

# åˆ›å»º Linux è™šæ‹Ÿæœº
./create-linux-vm.sh

# ç”Ÿæˆéšæœºç¡¬ä»¶å‚æ•°
./generate-hardware-params.sh

# è™šæ‹Ÿæœºç®¡ç†
./vm-manager.sh list
./vm-manager.sh start <vm_name>
```

---

## ğŸ“ QEMU æ ¸å¿ƒå‚æ•°é€ŸæŸ¥

### CPU é…ç½®
```bash
# éšè—è™šæ‹ŸåŒ–æ ‡è¯†
-cpu host,kvm=off,hv_vendor_id=GenuineIntel

# æŒ‡å®š CPU å‹å·
-cpu Skylake-Client

# CPU æ ¸å¿ƒé…ç½®
-smp cores=4,threads=2,sockets=1  # 4æ ¸8çº¿ç¨‹
-smp 4                             # ç®€åŒ–å†™æ³•ï¼š4æ ¸
```

### å†…å­˜é…ç½®
```bash
-m 4096   # 4GB
-m 8192   # 8GB
-m 16384  # 16GB
```

### SMBIOS é…ç½®
```bash
# BIOS ä¿¡æ¯ (Type 0)
-smbios type=0,vendor="å‚å•†",version="ç‰ˆæœ¬",date="æ—¥æœŸ"

# ç³»ç»Ÿä¿¡æ¯ (Type 1)
-smbios type=1,manufacturer="åˆ¶é€ å•†",product="äº§å“",serial="åºåˆ—å·",uuid="UUID"

# ä¸»æ¿ä¿¡æ¯ (Type 2)
-smbios type=2,manufacturer="åˆ¶é€ å•†",product="äº§å“",serial="åºåˆ—å·"

# æœºç®±ä¿¡æ¯ (Type 3)
-smbios type=3,manufacturer="åˆ¶é€ å•†",serial="åºåˆ—å·"
```

### ç¡¬ç›˜é…ç½®
```bash
# IDE ç¡¬ç›˜
-drive file=disk.qcow2,if=none,id=disk0,format=qcow2
-device ide-hd,drive=disk0,serial="åºåˆ—å·",model="å‹å·",wwn=0x50014ee2b5c6d8e9

# AHCI ç¡¬ç›˜
-device ahci,id=ahci
-drive file=disk.qcow2,if=none,id=disk0,format=qcow2
-device ide-hd,bus=ahci.0,drive=disk0,serial="åºåˆ—å·"

# VirtIO ç¡¬ç›˜ (é«˜æ€§èƒ½ï¼Œä½†æ˜“è¢«æ£€æµ‹)
-drive file=disk.qcow2,if=virtio,format=qcow2
```

### ç½‘ç»œé…ç½®
```bash
# ç”¨æˆ·æ¨¡å¼ç½‘ç»œ (NAT)
-netdev user,id=net0
-device e1000,netdev=net0,mac=00:1B:21:3A:4F:5C

# ç«¯å£è½¬å‘
-netdev user,id=net0,hostfwd=tcp::3389-:3389,hostfwd=tcp::2222-:22

# ç½‘æ¡¥æ¨¡å¼
-netdev bridge,id=net0,br=br0
-device e1000,netdev=net0,mac=00:1B:21:3A:4F:5C

# TAP æ¨¡å¼
-netdev tap,id=net0,ifname=tap0,script=no,downscript=no
-device e1000,netdev=net0,mac=00:1B:21:3A:4F:5C
```

### æ˜¾ç¤ºé…ç½®
```bash
-vga std          # æ ‡å‡† VGA
-vga qxl          # QXL (SPICE)
-vga virtio       # VirtIO GPU
-vga vmware       # VMware SVGA

-display gtk      # GTK çª—å£
-display sdl      # SDL çª—å£
-display vnc=:0   # VNC æœåŠ¡å™¨
-nographic        # æ— å›¾å½¢ç•Œé¢
```

### éŸ³é¢‘é…ç½®
```bash
# Intel HDA éŸ³é¢‘
-device intel-hda -device hda-duplex

# AC97 éŸ³é¢‘
-device AC97
```

### USB é…ç½®
```bash
# USB 3.0 æ§åˆ¶å™¨
-device qemu-xhci,id=xhci

# USB å¹³æ¿ (é¼ æ ‡)
-device usb-tablet,bus=xhci.0

# USB é”®ç›˜
-device usb-kbd,bus=xhci.0
```

### å¯åŠ¨é…ç½®
```bash
-boot order=c     # ä»ç¡¬ç›˜å¯åŠ¨
-boot order=d     # ä»å…‰é©±å¯åŠ¨
-boot order=n     # ä»ç½‘ç»œå¯åŠ¨

-cdrom windows.iso  # æŒ‚è½½ ISO
```

---

## ğŸ”§ ç£ç›˜ç®¡ç†å‘½ä»¤

### åˆ›å»ºç£ç›˜
```bash
# åˆ›å»º qcow2 æ ¼å¼ç£ç›˜
qemu-img create -f qcow2 disk.qcow2 100G

# åˆ›å»º raw æ ¼å¼ç£ç›˜
qemu-img create -f raw disk.img 100G

# åˆ›å»ºå¸¦åç«¯çš„ç£ç›˜ (å¢é‡)
qemu-img create -f qcow2 -b base.qcow2 disk.qcow2
```

### ç£ç›˜ä¿¡æ¯
```bash
# æŸ¥çœ‹ç£ç›˜ä¿¡æ¯
qemu-img info disk.qcow2

# æŸ¥çœ‹ç£ç›˜å®é™…å¤§å°
du -h disk.qcow2
```

### ç£ç›˜è½¬æ¢
```bash
# qcow2 è½¬ raw
qemu-img convert -f qcow2 -O raw disk.qcow2 disk.img

# raw è½¬ qcow2
qemu-img convert -f raw -O qcow2 disk.img disk.qcow2

# å‹ç¼© qcow2
qemu-img convert -f qcow2 -O qcow2 -c disk.qcow2 disk-compressed.qcow2
```

### ç£ç›˜è°ƒæ•´
```bash
# æ‰©å®¹
qemu-img resize disk.qcow2 +50G

# ç¼©å®¹ (éœ€è¦å…ˆåœ¨è™šæ‹Ÿæœºå†…ç¼©å°åˆ†åŒº)
qemu-img resize disk.qcow2 --shrink 80G
```

### å¿«ç…§ç®¡ç†
```bash
# åˆ›å»ºå¿«ç…§
qemu-img snapshot -c snapshot1 disk.qcow2

# åˆ—å‡ºå¿«ç…§
qemu-img snapshot -l disk.qcow2

# æ¢å¤å¿«ç…§
qemu-img snapshot -a snapshot1 disk.qcow2

# åˆ é™¤å¿«ç…§
qemu-img snapshot -d snapshot1 disk.qcow2
```

---

## ğŸŒ ç½‘ç»œé…ç½®

### å¸¸è§ç½‘å¡å‹å·
```bash
-device e1000           # Intel E1000 (æ¨èï¼Œå…¼å®¹æ€§å¥½)
-device e1000-82545em   # Intel E1000 (macOS)
-device rtl8139         # Realtek RTL8139
-device ne2k_pci        # NE2000
-device virtio-net-pci  # VirtIO (é«˜æ€§èƒ½ï¼Œæ˜“è¢«æ£€æµ‹)
```

### å¸¸è§å‚å•† MAC åœ°å€å‰ç¼€
```
Intel:     00:1B:21
Realtek:   00:E0:4C
Broadcom:  00:10:18
Qualcomm:  00:03:7F
Apple:     A4:83:E7
Dell:      D0:67:E5
HP:        70:5A:0F
```

### ç«¯å£è½¬å‘ç¤ºä¾‹
```bash
# SSH (22 -> 2222)
hostfwd=tcp::2222-:22

# RDP (3389 -> 3389)
hostfwd=tcp::3389-:3389

# HTTP (80 -> 8080)
hostfwd=tcp::8080-:80

# HTTPS (443 -> 8443)
hostfwd=tcp::8443-:443

# å¤šä¸ªç«¯å£
hostfwd=tcp::2222-:22,hostfwd=tcp::3389-:3389
```

---

## ğŸ–¥ï¸ å¸¸è§ç¡¬ä»¶é…ç½®æ¨¡æ¿

### ä½é…ç½® (æµ‹è¯•ç”¨)
```bash
-smp 2
-m 2048
-vga std
```

### ä¸­é…ç½® (æ—¥å¸¸ä½¿ç”¨)
```bash
-smp 4
-m 4096
-vga qxl
```

### é«˜é…ç½® (å¼€å‘/æ¸¸æˆ)
```bash
-smp cores=4,threads=2
-m 8192
-vga virtio
```

---

## ğŸ“Š SMBIOS å¸¸è§é…ç½®

### ASUS ä¸»æ¿
```bash
-smbios type=0,vendor="American Megatrends Inc.",version="F23"
-smbios type=1,manufacturer="ASUS",product="ROG STRIX B550-F GAMING"
-smbios type=2,manufacturer="ASUS",product="ROG STRIX B550-F GAMING"
```

### Dell å“ç‰Œæœº
```bash
-smbios type=0,vendor="Dell Inc.",version="A10"
-smbios type=1,manufacturer="Dell Inc.",product="OptiPlex 7090"
-smbios type=2,manufacturer="Dell Inc.",product="0DFXXD"
```

### HP å“ç‰Œæœº
```bash
-smbios type=0,vendor="HP",version="S01"
-smbios type=1,manufacturer="HP",product="EliteDesk 800 G8"
-smbios type=2,manufacturer="HP",product="8767"
```

### Lenovo å“ç‰Œæœº
```bash
-smbios type=0,vendor="Lenovo",version="M1AKT49A"
-smbios type=1,manufacturer="Lenovo",product="ThinkCentre M90t"
-smbios type=2,manufacturer="Lenovo",product="1046"
```

---

## ğŸ” æ£€æµ‹å‘½ä»¤é€ŸæŸ¥

### Windows æ£€æµ‹å‘½ä»¤
```cmd
# ç³»ç»Ÿä¿¡æ¯
systeminfo
wmic computersystem get manufacturer,model
wmic bios get manufacturer,serialnumber,version
wmic baseboard get manufacturer,product,serialnumber
wmic diskdrive get model,serialnumber
wmic cpu get name,manufacturer
wmic nic get macaddress,name

# PowerShell
Get-WmiObject Win32_ComputerSystem
Get-WmiObject Win32_BIOS
Get-WmiObject Win32_BaseBoard
Get-WmiObject Win32_DiskDrive
Get-WmiObject Win32_Processor
Get-WmiObject Win32_NetworkAdapter
```

### Linux æ£€æµ‹å‘½ä»¤
```bash
# SMBIOS ä¿¡æ¯
sudo dmidecode -t system
sudo dmidecode -t baseboard
sudo dmidecode -t bios
sudo dmidecode -t processor

# ç¡¬ç›˜ä¿¡æ¯
lsblk -o NAME,MODEL,SERIAL
sudo hdparm -I /dev/sda

# ç½‘å¡ä¿¡æ¯
ip link show
ifconfig -a

# è™šæ‹ŸåŒ–æ£€æµ‹
systemd-detect-virt
virt-what
lscpu | grep Hypervisor
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### è™šæ‹Ÿæœºæ— æ³•å¯åŠ¨
```bash
# æ£€æŸ¥ QEMU ç‰ˆæœ¬
qemu-system-x86_64 --version

# æ£€æŸ¥ KVM æ”¯æŒ
ls -l /dev/kvm

# æ£€æŸ¥ç£ç›˜é•œåƒ
qemu-img check disk.qcow2

# ä½¿ç”¨è½¯ä»¶æ¨¡æ‹Ÿ (æ…¢ä½†ç¨³å®š)
-machine type=q35,accel=tcg
```

### ç½‘ç»œæ— æ³•è¿æ¥
```bash
# æ£€æŸ¥ç½‘ç»œé…ç½®
ip addr show

# æµ‹è¯•ç«¯å£è½¬å‘
telnet localhost 2222

# ä½¿ç”¨æ¡¥æ¥æ¨¡å¼
-netdev bridge,id=net0,br=br0
```

### æ€§èƒ½é—®é¢˜
```bash
# å¯ç”¨ KVM åŠ é€Ÿ
-machine type=q35,accel=kvm

# å¢åŠ  CPU æ ¸å¿ƒ
-smp 8

# å¢åŠ å†…å­˜
-m 16384

# ä½¿ç”¨ VirtIO (æ€§èƒ½ä¼˜å…ˆ)
-drive file=disk.qcow2,if=virtio
-device virtio-net-pci
```

---

## ğŸ“š å‚è€ƒé“¾æ¥

- QEMU å®˜æ–¹æ–‡æ¡£: https://www.qemu.org/docs/master/
- QEMU å‘½ä»¤è¡Œå‚æ•°: https://www.qemu.org/docs/master/system/invocation.html
- SMBIOS è§„èŒƒ: https://www.dmtf.org/standards/smbios
- PCI è®¾å¤‡ ID: https://pci-ids.ucw.cz/
- MAC åœ°å€æŸ¥è¯¢: https://maclookup.app/

---

**æç¤º**: å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸ºä¹¦ç­¾ï¼Œæ–¹ä¾¿éšæ—¶æŸ¥é˜…ï¼
